@mindflayer:

Please see https://gist.github.com/D630/8f89a7fa81efd3ab6e7b50b2b6831843
